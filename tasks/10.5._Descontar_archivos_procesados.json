{"task":{"order":0,"enable":true,"type":"script","public":false,"tags":[],"grace_time":0,"task_arguments":[],"arguments_type":"legacy","output_parameters":[],"register_body":false,"execution_count":138,"multitasking":true,"show_result":false,"assigned_users":[],"user_inputs":false,"user_inputs_members":[],"empty_viewers":false,"cancellable":true,"autoremove_completed_jobs_limit":5,"script_arguments":[],"logging":false,"_type":"ScriptTask","creation_date":"2022-01-11T11:48:27.450Z","last_update":"2022-01-24T19:13:20.401Z","env":{"INTEGRATION_TOKEN":"","WF_ID":"","WF_SECRET":""},"name":"10.5. Descontar archivos procesados","description":"","timeout":600000,"allows_dynamic_settings":false,"script_runas":"node %script%","template":null,"template_id":null,"source_model_id":"61dd6e8b724e690012fa6f75"},"file":{"order":0,"filename":"section_10.5.js","keyname":"section_10.5.js[ts:1643051573159]","mimetype":"text/javascript","extension":"js","size":3718,"description":"","md5":"64eb6722739fa2663d452e6df7109320","public":false,"tags":[],"source_model_id":"61dd6dd8724e690012fa6f4e","data":"Ly8gZXJyb3IgYW5kIG91dHB1dCBoYW5kbGVycyBtdXN0IGdvIGZpcnN0LgoKLyoqCiAqIEBwYXJhbSB7T2JqZWN0fQogKiBAcHJvcCB7TWl4ZWR9IGRhdGEKICogQHByb3Age0FycmF5fSBjb21wb25lbnRzCiAqIEBwcm9wIHtPYmplY3R9IG5leHQKICovCmNvbnN0IHN1Y2Nlc3NPdXRwdXQgPSAoeyBkYXRhLCBjb21wb25lbnRzLCBuZXh0IH0pID0+IHsKICAvLyBodHRwczovL2RvY3VtZW50YXRpb24udGhlZXllLmlvL2NvcmUtY29uY2VwdHMvc2NyaXB0cy8jcGFzc2luZy1hcmd1bWVudHMtaW4td29ya2Zsb3cKICBjb25zdCBvdXRwdXQgPSB7CiAgICBzdGF0ZTogInN1Y2Nlc3MiLAogICAgZGF0YSwKICAgIGNvbXBvbmVudHMsIC8vIGh0dHBzOi8vZG9jdW1lbnRhdGlvbi50aGVleWUuaW8vY29yZS1jb25jZXB0cy90YXNrcy9zY3JpcHRfdHlwZS8jY29tcG9uZW50cwogICAgbmV4dAogIH0KICBjb25zb2xlLmxvZyggSlNPTi5zdHJpbmdpZnkob3V0cHV0KSApCiAgcHJvY2Vzcy5leGl0KDApCn0KCi8qKgogKiBAcGFyYW0ge0Vycm9yfSBlcnIKICovCmNvbnN0IGZhaWx1cmVPdXRwdXQgPSAoZXJyKSA9PiB7CiAgY29uc29sZS5lcnJvcihlcnIpCiAgY29uc3Qgb3V0cHV0ID0gewogICAgc3RhdGU6ICJmYWlsdXJlIiwKICAgIGRhdGE6IHsKICAgICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UsCiAgICAgIGNvZGU6IGVyci5jb2RlLAogICAgICBkYXRhOiBlcnIuZGF0YSAKICAgIH0KICB9CiAgY29uc29sZS5lcnJvciggSlNPTi5zdHJpbmdpZnkob3V0cHV0KSApCiAgcHJvY2Vzcy5leGl0KDEpCn0KCnByb2Nlc3Mub24oJ3VuaGFuZGxlZFJlamVjdGlvbicsIChyZWFzb24sIHApID0+IHsKICBjb25zb2xlLmVycm9yKHJlYXNvbiwgJ1VuaGFuZGxlZCBSZWplY3Rpb24gYXQgUHJvbWlzZScsIHApCiAgZmFpbHVyZU91dHB1dChyZWFzb24pCn0pCgpwcm9jZXNzLm9uKCd1bmNhdWdodEV4Y2VwdGlvbicsIGVyciA9PiB7CiAgY29uc29sZS5lcnJvcihlcnIsICdVbmNhdWdodCBFeGNlcHRpb24gdGhyb3duJykKICBmYWlsdXJlT3V0cHV0KGVycikKfSkKCmNvbnN0IGdvdCA9IHJlcXVpcmUoJ2dvdCcpCmNvbnN0IGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKQpjb25zdCB7IFVSTCB9ID0gcmVxdWlyZSgndXJsJykKCmNvbnN0IEFQSV9VUkwgPSBKU09OLnBhcnNlKHByb2Nlc3MuZW52LlRIRUVZRV9BUElfVVJMKQpjb25zdCBJTlRFR1JBVElPTl9UT0tFTiA9IHByb2Nlc3MuZW52LklOVEVHUkFUSU9OX1RPS0VOCgpjb25zdCBXRl9JRCA9IHByb2Nlc3MuZW52LldGX0lECmNvbnN0IFdGX1NFQ1JFVCA9IHByb2Nlc3MuZW52LldGX1NFQ1JFVAoKY29uc3QgQ2FjaGUgPSByZXF1aXJlKCd0aGVleWUtc2RrL2NvcmUvYm90L2NhY2hlJykKCgphc3luYyBmdW5jdGlvbiBtYWluICgpIHsKICAKICBjb25zdCBhcmdzID0gcHJvY2Vzcy5hcmd2LnNsaWNlKDIpCiAgCiAgY29uc3QgY2FjaGUgPSBuZXcgQ2FjaGUoKQogIGNvbnN0IHRpdGxlID0gY2FjaGUuZ2V0KCkubG90ZQogIAogIGNvbnNvbGUubG9nKCd1cGRhdGluZyBpbmRpY2F0b3InKQogIC8vCiAgLy8gcHJvdmlzaW9uYWwuIGxhIGFwaSBkZSBjb250YWRvciBubyBhZG1pdGUgVVJMIGNvbiB0w610dWxvLgogIC8vCiAgbGV0IHJlc3BvbnNlCgogIGNvbnN0IGdldFVybCA9IGVuY29kZVVSSShgJHtBUElfVVJMfS9pbmRpY2F0b3IvdGl0bGUvJHt0aXRsZX0/YWNjZXNzX3Rva2VuPSR7SU5URUdSQVRJT05fVE9LRU59YCkKICByZXNwb25zZSA9IGF3YWl0IGdvdC5nZXQoZ2V0VXJsLCB7cmVzcG9uc2VUeXBlOidqc29uJ30pLmNhdGNoKGVyciA9PiBlcnIpCiAgCiAgY29uc3QgY291bnRlciA9IHJlc3BvbnNlLmJvZHkudmFsdWUKICAKICBjb25zdCBwYXRjaFVybCA9IGVuY29kZVVSSShgJHtBUElfVVJMfS9pbmRpY2F0b3IvJHtyZXNwb25zZS5ib2R5LmlkfS9kZWNyZWFzZT9hY2Nlc3NfdG9rZW49JHtJTlRFR1JBVElPTl9UT0tFTn1gKQogIHJlc3BvbnNlID0gYXdhaXQgZ290LnBhdGNoKHBhdGNoVXJsLCB7cmVzcG9uc2VUeXBlOidqc29uJ30pLmNhdGNoKGVyciA9PiBlcnIpCiAgCiAgaWYgKHJlc3BvbnNlIGluc3RhbmNlb2YgRXJyb3IpIHsKICAgIGNvbnN0IGVyciA9IG5ldyBFcnJvcihyZXNwb25zZS5tZXNzYWdlKQogICAgZXJyLmRhdGEgPSByZXNwb25zZS5yZXNwb25zZS5ib2R5CiAgICBlcnIuY29kZSA9IHJlc3BvbnNlLnJlc3BvbnNlLnN0YXR1c0NvZGUKICAgIHRocm93IGVycgogIH0gZWxzZSB7CiAgICBpZiAoY291bnRlciA9PT0gMSkgewogICAgICBjb25zb2xlLmxvZygnbGFuemFuZG8gd29ya2Zsb3cgZGUgZ2VuZXJhY2nDs24gZGUgcmVwb3J0ZScpCiAgICAgIGNvbnN0IHRhc2tfYXJndW1lbnRzID0gWyB0aXRsZSBdCiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbGF1bmNoV29ya2Zsb3codGFza19hcmd1bWVudHMpCiAgICB9CiAgICByZXR1cm4geyBkYXRhOiByZXNwb25zZS5ib2R5LmRhdGEgfQogIH0KfQoKY29uc3QgbGF1bmNoV29ya2Zsb3cgPSAodGFza19hcmd1bWVudHMpID0+IHsKICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewoKICAgIGNvbnN0IHdmVXJsID0gYCR7QVBJX1VSTH0vd29ya2Zsb3dzLyR7V0ZfSUR9L3NlY3JldC8ke1dGX1NFQ1JFVH0vam9iYAogICAgY29uc3QgdXJsID0gbmV3IFVSTCh3ZlVybCkKCiAgICBjb25zdCByZXFPcHRzID0gewogICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgaGVhZGVyczogeyAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sCiAgICAgIHBvcnQ6IHVybC5wb3J0LAogICAgICBob3N0bmFtZTogdXJsLmhvc3RuYW1lLAogICAgICBwYXRoOiBgJHt1cmwucGF0aG5hbWV9JHt1cmwuc2VhcmNofWAKICAgIH0KICAgIAogICAgY29uc3QgcmVxID0gaHR0cHMucmVxdWVzdChyZXFPcHRzLCByZXMgPT4gewogICAgICBsZXQgc3RyID0gJycKICAgICAgcmVzLm9uKCdkYXRhJywgZCA9PiB7CiAgICAgICAgaWYgKGQpIHsgc3RyICs9IGQ7IH0KICAgICAgfSkKICAgICAgcmVzLm9uKCdlbmQnLCAoKSA9PiB7CiAgICAgICAgcmVzLmJvZHkgPSBzdHIKICAgICAgICAKICAgICAgICBpZiAocmVzLnN0YXR1c0NvZGUgPj0gNTAwKSB7CiAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignSW50ZXJuYWwgU2VydmVyIEVycm9yJykKICAgICAgICAgIGVycm9yLnJlcyA9IHJlcwogICAgICAgICAgcmV0dXJuIHJlamVjdChlcnJvcikKICAgICAgICB9CiAgICAgICAgaWYgKHJlcy5zdGF0dXNDb2RlID49IDQwMCkgewogICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0ludmFsaWQgUmVxdWVzdCcpCiAgICAgICAgICBlcnJvci5yZXMgPSByZXMKICAgICAgICAgIHJldHVybiByZWplY3QoZXJyb3IpCiAgICAgICAgfQogICAgICAgIHJlc29sdmUocmVzKQogICAgICB9KQogICAgfSkKCiAgICByZXEub24oJ2Vycm9yJywgcmVqZWN0KQoKICAgIGlmICh0YXNrX2FyZ3VtZW50cykgewogICAgICBjb25zb2xlLmxvZyh0YXNrX2FyZ3VtZW50cykKICAgICAgY29uc3QgcGF5bG9hZCA9IEpTT04uc3RyaW5naWZ5KHRhc2tfYXJndW1lbnRzKQogICAgICByZXEud3JpdGUocGF5bG9hZCkKICAgIH0KCiAgICByZXEuZW5kKCkKICB9KQp9CgovLyBpbnZva2UgbWFpbiBhbmQgY2FwdHVyZSByZXN1bHQgb3V0cHV0Cm1haW4oKS50aGVuKHN1Y2Nlc3NPdXRwdXQpLmNhdGNoKGZhaWx1cmVPdXRwdXQpCg=="}}