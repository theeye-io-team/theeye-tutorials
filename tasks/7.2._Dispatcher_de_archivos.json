{"task":{"order":0,"enable":true,"type":"script","public":false,"tags":["section 7"],"grace_time":0,"task_arguments":[{"id":2,"order":0,"type":"input","label":"lote","value":"","help":"","readonly":false,"required":true,"multiple":false,"masked":false,"charsmin":0,"charsmax":0,"charset":null,"pattern":"","options":[]},{"id":1,"order":1,"type":"json","label":"files list","value":"","help":"","readonly":false,"required":true,"multiple":false,"masked":false,"options":[]}],"arguments_type":"legacy","output_parameters":[],"register_body":false,"execution_count":50,"multitasking":true,"show_result":false,"assigned_users":[],"user_inputs":false,"user_inputs_members":[],"empty_viewers":false,"cancellable":true,"autoremove_completed_jobs_limit":5,"script_arguments":[{"id":2,"order":0,"type":"input","label":"lote","value":"","help":"","readonly":false,"required":true,"multiple":false,"masked":false,"charsmin":0,"charsmax":0,"charset":null,"pattern":"","options":[]},{"id":1,"order":1,"type":"json","label":"files list","value":"","help":"","readonly":false,"required":true,"multiple":false,"masked":false,"options":[]}],"logging":false,"_type":"ScriptTask","creation_date":"2021-12-23T01:35:47.835Z","last_update":"2022-01-18T01:27:13.298Z","env":{"CASO1_WF_ID":"","CASO1_WF_SECRET":""},"name":"7.2. Dispatcher de archivos","description":"","timeout":600000,"allows_dynamic_settings":false,"script_runas":"node %script%","template":null,"template_id":null,"source_model_id":"61c3d273323cb80012820c82"},"file":{"order":0,"filename":"section_7.2.js","keyname":"section_7.2.js[ts:1642438481439]","mimetype":"text/javascript","extension":"js","size":3263,"description":"","md5":"2094113f2abacab2af8d8872bb782325","public":false,"tags":[],"source_model_id":"61c3d2542a78c9001970bc46","data":"Ly8gZXJyb3IgYW5kIG91dHB1dCBoYW5kbGVycyBtdXN0IGdvIGZpcnN0LgoKLyoqCiAqIEBwYXJhbSB7T2JqZWN0fQogKiBAcHJvcCB7TWl4ZWR9IGRhdGEKICogQHByb3Age0FycmF5fSBjb21wb25lbnRzCiAqIEBwcm9wIHtPYmplY3R9IG5leHQKICovCmNvbnN0IHN1Y2Nlc3NPdXRwdXQgPSAoeyBkYXRhLCBjb21wb25lbnRzLCBuZXh0IH0pID0+IHsKICAvLyBodHRwczovL2RvY3VtZW50YXRpb24udGhlZXllLmlvL2NvcmUtY29uY2VwdHMvc2NyaXB0cy8jcGFzc2luZy1hcmd1bWVudHMtaW4td29ya2Zsb3cKICBjb25zdCBvdXRwdXQgPSB7CiAgICBzdGF0ZTogInN1Y2Nlc3MiLAogICAgZGF0YSwKICAgIGNvbXBvbmVudHMsIC8vIGh0dHBzOi8vZG9jdW1lbnRhdGlvbi50aGVleWUuaW8vY29yZS1jb25jZXB0cy90YXNrcy9zY3JpcHRfdHlwZS8jY29tcG9uZW50cwogICAgbmV4dAogIH0KICBjb25zb2xlLmxvZyggSlNPTi5zdHJpbmdpZnkob3V0cHV0KSApCiAgcHJvY2Vzcy5leGl0KDApCn0KCi8qKgogKiBAcGFyYW0ge0Vycm9yfSBlcnIKICovCmNvbnN0IGZhaWx1cmVPdXRwdXQgPSAoZXJyKSA9PiB7CiAgY29uc29sZS5lcnJvcihlcnIubWVzc2FnZSkKICBjb25zdCBvdXRwdXQgPSB7CiAgICBzdGF0ZTogImZhaWx1cmUiLAogICAgZGF0YTogewogICAgICBtZXNzYWdlOiBlcnIubWVzc2FnZSwKICAgICAgY29kZTogZXJyLmNvZGUsCiAgICAgIGRhdGE6IGVyci5kYXRhIAogICAgfQogIH0KICBjb25zb2xlLmVycm9yKCBKU09OLnN0cmluZ2lmeShvdXRwdXQpICkKICBwcm9jZXNzLmV4aXQoMSkKfQoKcHJvY2Vzcy5vbigndW5oYW5kbGVkUmVqZWN0aW9uJywgKHJlYXNvbiwgcCkgPT4gewogIGNvbnNvbGUuZXJyb3IocmVhc29uLCAnVW5oYW5kbGVkIFJlamVjdGlvbiBhdCBQcm9taXNlJywgcCkKICBmYWlsdXJlT3V0cHV0KHJlYXNvbikKfSkKCnByb2Nlc3Mub24oJ3VuY2F1Z2h0RXhjZXB0aW9uJywgZXJyID0+IHsKICBjb25zb2xlLmVycm9yKGVyciwgJ1VuY2F1Z2h0IEV4Y2VwdGlvbiB0aHJvd24nKQogIGZhaWx1cmVPdXRwdXQoZXJyKQp9KQoKY29uc3QgZnMgPSByZXF1aXJlKCdmcycpCmNvbnN0IGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKQpjb25zdCB7IFVSTCB9ID0gcmVxdWlyZSgndXJsJykKCmNvbnN0IFdGX0lEID0gcHJvY2Vzcy5lbnYuQ0FTTzFfV0ZfSUQKY29uc3QgV0ZfU0VDUkVUID0gcHJvY2Vzcy5lbnYuQ0FTTzFfV0ZfU0VDUkVUCmNvbnN0IEFQSV9VUkwgPSBKU09OLnBhcnNlKHByb2Nlc3MuZW52LlRIRUVZRV9BUElfVVJMKQpjb25zdCBPUkdfTkFNRSA9IEpTT04ucGFyc2UocHJvY2Vzcy5lbnYuVEhFRVlFX09SR0FOSVpBVElPTl9OQU1FKQoKLy8gZGlzdHBhY2hlcgpjb25zdCBtYWluID0gbW9kdWxlLmV4cG9ydHMgPSBhc3luYyAoKSA9PiB7CiAgY29uc3QgYXJncyA9IHByb2Nlc3MuYXJndi5zbGljZSgyKQogIGNvbnN0IGxvdGUgPSBhcmdzWzBdCiAgY29uc3QgZmlsZW5hbWVzID0gSlNPTi5wYXJzZShhcmdzWzFdKQoKICBjb25zdCBwcm9taXNlcyA9IFtdCiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGZpbGVuYW1lcy5sZW5ndGg7IGluZGV4KyspIHsKICAgIGNvbnN0IGZpbGVuYW1lID0gZmlsZW5hbWVzW2luZGV4XQogICAgCiAgICBjb25zdCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVuYW1lKQogICAgY29uc3QgbWltZSA9ICd0ZXh0L3BsYWluJwogICAgY29uc3QgZGF0YSA9IGBkYXRhOiR7bWltZX07YmFzZTY0LCR7Y29udGVudC50b1N0cmluZygnYmFzZTY0Jyl9YAoKICAgIGNvbnNvbGUubG9nKGBydW5uaW5nIHdvcmtmbG93IGZvciBmaWxlICR7ZmlsZW5hbWV9YCkKCiAgICBjb25zdCB0YXNrX2FyZ3VtZW50cyA9IFsgbG90ZSwgZGF0YSwgWydCUlVUTycsJ0ZFRSddIF0KICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbGF1bmNoV29ya2Zsb3codGFza19hcmd1bWVudHMpCiAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5ib2R5KQogIH0KCiAgcmV0dXJuIHt9Cn0KCmNvbnN0IGxhdW5jaFdvcmtmbG93ID0gKHRhc2tfYXJndW1lbnRzKSA9PiB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKCiAgICBjb25zdCB3ZlVybCA9IGAke0FQSV9VUkx9L3dvcmtmbG93cy8ke1dGX0lEfS9zZWNyZXQvJHtXRl9TRUNSRVR9L2pvYj9jdXN0b21lcj0ke09SR19OQU1FfWAKICAgIGNvbnN0IHVybCA9IG5ldyBVUkwod2ZVcmwpCgogICAgY29uc3QgcmVxT3B0cyA9IHsKICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgIGhlYWRlcnM6IHsgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LAogICAgICBwb3J0OiB1cmwucG9ydCwKICAgICAgaG9zdG5hbWU6IHVybC5ob3N0bmFtZSwKICAgICAgcGF0aDogYCR7dXJsLnBhdGhuYW1lfSR7dXJsLnNlYXJjaH1gCiAgICB9CiAgICAKICAgIGNvbnN0IHJlcSA9IGh0dHBzLnJlcXVlc3QocmVxT3B0cywgcmVzID0+IHsKICAgICAgbGV0IHN0ciA9ICcnCiAgICAgIHJlcy5vbignZGF0YScsIGQgPT4gewogICAgICAgIGlmIChkKSB7IHN0ciArPSBkOyB9CiAgICAgIH0pCiAgICAgIHJlcy5vbignZW5kJywgKCkgPT4gewogICAgICAgIHJlcy5ib2R5ID0gc3RyCiAgICAgICAgCiAgICAgICAgaWYgKHJlcy5zdGF0dXNDb2RlID49IDUwMCkgewogICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0ludGVybmFsIFNlcnZlciBFcnJvcicpCiAgICAgICAgICBlcnJvci5yZXMgPSByZXMKICAgICAgICAgIHJldHVybiByZWplY3QoZXJyb3IpCiAgICAgICAgfQogICAgICAgIGlmIChyZXMuc3RhdHVzQ29kZSA+PSA0MDApIHsKICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdJbnZhbGlkIFJlcXVlc3QnKQogICAgICAgICAgZXJyb3IucmVzID0gcmVzCiAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycm9yKQogICAgICAgIH0KICAgICAgICByZXNvbHZlKHJlcykKICAgICAgfSkKICAgIH0pCgogICAgcmVxLm9uKCdlcnJvcicsIHJlamVjdCkKCiAgICBpZiAodGFza19hcmd1bWVudHMpIHsKICAgICAgY29uc29sZS5sb2codGFza19hcmd1bWVudHMpCiAgICAgIGNvbnN0IHBheWxvYWQgPSBKU09OLnN0cmluZ2lmeSh0YXNrX2FyZ3VtZW50cykKICAgICAgcmVxLndyaXRlKHBheWxvYWQpCiAgICB9CgogICAgcmVxLmVuZCgpCiAgfSkKfQoKLy8gaW52b2tlIG1haW4gYW5kIGNhcHR1cmUgcmVzdWx0IG91dHB1dAptYWluKCkudGhlbihzdWNjZXNzT3V0cHV0KS5jYXRjaChmYWlsdXJlT3V0cHV0KQo="}}