{"task":{"order":0,"enable":true,"type":"script","public":false,"tags":[],"grace_time":0,"task_arguments":[{"id":1,"order":0,"type":"input","label":"lote","value":"","help":"","readonly":false,"required":true,"multiple":false,"masked":false,"charsmin":0,"charsmax":0,"charset":null,"pattern":"","options":[]}],"arguments_type":"legacy","output_parameters":[],"register_body":false,"execution_count":107,"multitasking":true,"show_result":false,"assigned_users":[],"user_inputs":false,"user_inputs_members":[],"empty_viewers":false,"cancellable":true,"autoremove_completed_jobs_limit":5,"script_arguments":[{"id":1,"order":0,"type":"input","label":"lote","value":"","help":"","readonly":false,"required":true,"multiple":false,"masked":false,"charsmin":0,"charsmax":0,"charset":null,"pattern":"","options":[]}],"logging":false,"_type":"ScriptTask","creation_date":"2022-01-11T11:48:27.450Z","last_update":"2022-01-18T01:59:40.693Z","env":{"INTEGRATION_TOKEN":"","WF_ID":"","WF_SECRET":""},"name":"8.3. Descontar archivos procesados","description":"","timeout":600000,"allows_dynamic_settings":false,"script_runas":"node %script%","template":null,"template_id":null,"source_model_id":"61dd6e8b724e690012fa6f75"},"file":{"order":0,"filename":"section_8.3.js","keyname":"section_8.3.js[ts:1642469222286]","mimetype":"text/javascript","extension":"js","size":3626,"description":"","md5":"4168401d281ba2ff682443659aa25af2","public":false,"tags":[],"source_model_id":"61dd6dd8724e690012fa6f4e","data":"Ly8gZXJyb3IgYW5kIG91dHB1dCBoYW5kbGVycyBtdXN0IGdvIGZpcnN0LgoKLyoqCiAqIEBwYXJhbSB7T2JqZWN0fQogKiBAcHJvcCB7TWl4ZWR9IGRhdGEKICogQHByb3Age0FycmF5fSBjb21wb25lbnRzCiAqIEBwcm9wIHtPYmplY3R9IG5leHQKICovCmNvbnN0IHN1Y2Nlc3NPdXRwdXQgPSAoeyBkYXRhLCBjb21wb25lbnRzLCBuZXh0IH0pID0+IHsKICAvLyBodHRwczovL2RvY3VtZW50YXRpb24udGhlZXllLmlvL2NvcmUtY29uY2VwdHMvc2NyaXB0cy8jcGFzc2luZy1hcmd1bWVudHMtaW4td29ya2Zsb3cKICBjb25zdCBvdXRwdXQgPSB7CiAgICBzdGF0ZTogInN1Y2Nlc3MiLAogICAgZGF0YSwKICAgIGNvbXBvbmVudHMsIC8vIGh0dHBzOi8vZG9jdW1lbnRhdGlvbi50aGVleWUuaW8vY29yZS1jb25jZXB0cy90YXNrcy9zY3JpcHRfdHlwZS8jY29tcG9uZW50cwogICAgbmV4dAogIH0KICBjb25zb2xlLmxvZyggSlNPTi5zdHJpbmdpZnkob3V0cHV0KSApCiAgcHJvY2Vzcy5leGl0KDApCn0KCi8qKgogKiBAcGFyYW0ge0Vycm9yfSBlcnIKICovCmNvbnN0IGZhaWx1cmVPdXRwdXQgPSAoZXJyKSA9PiB7CiAgY29uc29sZS5lcnJvcihlcnIpCiAgY29uc3Qgb3V0cHV0ID0gewogICAgc3RhdGU6ICJmYWlsdXJlIiwKICAgIGRhdGE6IHsKICAgICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UsCiAgICAgIGNvZGU6IGVyci5jb2RlLAogICAgICBkYXRhOiBlcnIuZGF0YSAKICAgIH0KICB9CiAgY29uc29sZS5lcnJvciggSlNPTi5zdHJpbmdpZnkob3V0cHV0KSApCiAgcHJvY2Vzcy5leGl0KDEpCn0KCnByb2Nlc3Mub24oJ3VuaGFuZGxlZFJlamVjdGlvbicsIChyZWFzb24sIHApID0+IHsKICBjb25zb2xlLmVycm9yKHJlYXNvbiwgJ1VuaGFuZGxlZCBSZWplY3Rpb24gYXQgUHJvbWlzZScsIHApCiAgZmFpbHVyZU91dHB1dChyZWFzb24pCn0pCgpwcm9jZXNzLm9uKCd1bmNhdWdodEV4Y2VwdGlvbicsIGVyciA9PiB7CiAgY29uc29sZS5lcnJvcihlcnIsICdVbmNhdWdodCBFeGNlcHRpb24gdGhyb3duJykKICBmYWlsdXJlT3V0cHV0KGVycikKfSkKCmNvbnN0IGdvdCA9IHJlcXVpcmUoJ2dvdCcpCmNvbnN0IGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKQpjb25zdCB7IFVSTCB9ID0gcmVxdWlyZSgndXJsJykKCmNvbnN0IEFQSV9VUkwgPSBKU09OLnBhcnNlKHByb2Nlc3MuZW52LlRIRUVZRV9BUElfVVJMKQpjb25zdCBJTlRFR1JBVElPTl9UT0tFTiA9IHByb2Nlc3MuZW52LklOVEVHUkFUSU9OX1RPS0VOCgpjb25zdCBXRl9JRCA9IHByb2Nlc3MuZW52LldGX0lECmNvbnN0IFdGX1NFQ1JFVCA9IHByb2Nlc3MuZW52LldGX1NFQ1JFVAoKCmFzeW5jIGZ1bmN0aW9uIG1haW4gKCkgewogIAogIGNvbnN0IGFyZ3MgPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMikKICBjb25zdCB0aXRsZSA9IGFyZ3NbMF0KICAKICBjb25zb2xlLmxvZygndXBkYXRpbmcgaW5kaWNhdG9yJykKICAvLwogIC8vIHByb3Zpc2lvbmFsLiBsYSBhcGkgZGUgY29udGFkb3Igbm8gYWRtaXRlIFVSTCBjb24gdMOtdHVsby4KICAvLwogIGxldCByZXNwb25zZQoKICBjb25zdCBnZXRVcmwgPSBlbmNvZGVVUkkoYCR7QVBJX1VSTH0vaW5kaWNhdG9yL3RpdGxlLyR7dGl0bGV9P2FjY2Vzc190b2tlbj0ke0lOVEVHUkFUSU9OX1RPS0VOfWApCiAgcmVzcG9uc2UgPSBhd2FpdCBnb3QuZ2V0KGdldFVybCwge3Jlc3BvbnNlVHlwZTonanNvbid9KS5jYXRjaChlcnIgPT4gZXJyKQogIAogIGNvbnN0IGNvdW50ZXIgPSByZXNwb25zZS5ib2R5LnZhbHVlCiAgCiAgY29uc3QgcGF0Y2hVcmwgPSBlbmNvZGVVUkkoYCR7QVBJX1VSTH0vaW5kaWNhdG9yLyR7cmVzcG9uc2UuYm9keS5pZH0vZGVjcmVhc2U/YWNjZXNzX3Rva2VuPSR7SU5URUdSQVRJT05fVE9LRU59YCkKICByZXNwb25zZSA9IGF3YWl0IGdvdC5wYXRjaChwYXRjaFVybCwge3Jlc3BvbnNlVHlwZTonanNvbid9KS5jYXRjaChlcnIgPT4gZXJyKQogIAogIGlmIChyZXNwb25zZSBpbnN0YW5jZW9mIEVycm9yKSB7CiAgICBjb25zdCBlcnIgPSBuZXcgRXJyb3IocmVzcG9uc2UubWVzc2FnZSkKICAgIGVyci5kYXRhID0gcmVzcG9uc2UucmVzcG9uc2UuYm9keQogICAgZXJyLmNvZGUgPSByZXNwb25zZS5yZXNwb25zZS5zdGF0dXNDb2RlCiAgICB0aHJvdyBlcnIKICB9IGVsc2UgewogICAgaWYgKGNvdW50ZXIgPT09IDEpIHsKICAgICAgY29uc29sZS5sb2coJ2xhbnphbmRvIHdvcmtmbG93IGRlIGdlbmVyYWNpw7NuIGRlIHJlcG9ydGUnKQogICAgICBjb25zdCB0YXNrX2FyZ3VtZW50cyA9IFsgdGl0bGUgXQogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGxhdW5jaFdvcmtmbG93KHRhc2tfYXJndW1lbnRzKQogICAgfQogICAgcmV0dXJuIHsgZGF0YTogcmVzcG9uc2UuYm9keS5kYXRhIH0KICB9Cn0KCmNvbnN0IGxhdW5jaFdvcmtmbG93ID0gKHRhc2tfYXJndW1lbnRzKSA9PiB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKCiAgICBjb25zdCB3ZlVybCA9IGAke0FQSV9VUkx9L3dvcmtmbG93cy8ke1dGX0lEfS9zZWNyZXQvJHtXRl9TRUNSRVR9L2pvYmAKICAgIGNvbnN0IHVybCA9IG5ldyBVUkwod2ZVcmwpCgogICAgY29uc3QgcmVxT3B0cyA9IHsKICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgIGhlYWRlcnM6IHsgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LAogICAgICBwb3J0OiB1cmwucG9ydCwKICAgICAgaG9zdG5hbWU6IHVybC5ob3N0bmFtZSwKICAgICAgcGF0aDogYCR7dXJsLnBhdGhuYW1lfSR7dXJsLnNlYXJjaH1gCiAgICB9CiAgICAKICAgIGNvbnN0IHJlcSA9IGh0dHBzLnJlcXVlc3QocmVxT3B0cywgcmVzID0+IHsKICAgICAgbGV0IHN0ciA9ICcnCiAgICAgIHJlcy5vbignZGF0YScsIGQgPT4gewogICAgICAgIGlmIChkKSB7IHN0ciArPSBkOyB9CiAgICAgIH0pCiAgICAgIHJlcy5vbignZW5kJywgKCkgPT4gewogICAgICAgIHJlcy5ib2R5ID0gc3RyCiAgICAgICAgCiAgICAgICAgaWYgKHJlcy5zdGF0dXNDb2RlID49IDUwMCkgewogICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0ludGVybmFsIFNlcnZlciBFcnJvcicpCiAgICAgICAgICBlcnJvci5yZXMgPSByZXMKICAgICAgICAgIHJldHVybiByZWplY3QoZXJyb3IpCiAgICAgICAgfQogICAgICAgIGlmIChyZXMuc3RhdHVzQ29kZSA+PSA0MDApIHsKICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdJbnZhbGlkIFJlcXVlc3QnKQogICAgICAgICAgZXJyb3IucmVzID0gcmVzCiAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycm9yKQogICAgICAgIH0KICAgICAgICByZXNvbHZlKHJlcykKICAgICAgfSkKICAgIH0pCgogICAgcmVxLm9uKCdlcnJvcicsIHJlamVjdCkKCiAgICBpZiAodGFza19hcmd1bWVudHMpIHsKICAgICAgY29uc29sZS5sb2codGFza19hcmd1bWVudHMpCiAgICAgIGNvbnN0IHBheWxvYWQgPSBKU09OLnN0cmluZ2lmeSh0YXNrX2FyZ3VtZW50cykKICAgICAgcmVxLndyaXRlKHBheWxvYWQpCiAgICB9CgogICAgcmVxLmVuZCgpCiAgfSkKfQoKLy8gaW52b2tlIG1haW4gYW5kIGNhcHR1cmUgcmVzdWx0IG91dHB1dAptYWluKCkudGhlbihzdWNjZXNzT3V0cHV0KS5jYXRjaChmYWlsdXJlT3V0cHV0KQo="}}